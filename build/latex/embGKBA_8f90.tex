\hypertarget{embGKBA_8f90}{}\doxysection{/home/nlgnico@ad.\+vtt.\+fi/\+Documents/\+N\+E\+G\+Fs/gkba/src/emb\+G\+K\+BA.f90 File Reference}
\label{embGKBA_8f90}\index{/home/nlgnico"@ad.vtt.fi/Documents/NEGFs/gkba/src/embGKBA.f90@{/home/nlgnico"@ad.vtt.fi/Documents/NEGFs/gkba/src/embGKBA.f90}}
\doxysubsection*{Functions/\+Subroutines}
\begin{Indent}\textbf{ E\+M\+B\+G\+K\+BA}\par
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{embGKBA_8f90_acc39ee86683ef3dae78e530e283b574c}{embgkba}} (D\+T\+I\+ME, N\+T\+I\+ME, NS, B\+E\+TA, MU, GC, G\+A\+M\+MA, E\+M\+B\+S\+L\+FL, E\+M\+B\+S\+L\+FG)
\end{DoxyCompactItemize}
\end{Indent}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{embGKBA_8f90_acc39ee86683ef3dae78e530e283b574c}\label{embGKBA_8f90_acc39ee86683ef3dae78e530e283b574c}} 
\index{embGKBA.f90@{embGKBA.f90}!embgkba@{embgkba}}
\index{embgkba@{embgkba}!embGKBA.f90@{embGKBA.f90}}
\doxysubsubsection{\texorpdfstring{embgkba()}{embgkba()}}
{\footnotesize\ttfamily subroutine embgkba (\begin{DoxyParamCaption}\item[{double precision, intent(in)}]{D\+T\+I\+ME,  }\item[{integer, intent(in)}]{N\+T\+I\+ME,  }\item[{integer, intent(in)}]{NS,  }\item[{double precision, intent(in)}]{B\+E\+TA,  }\item[{double precision, intent(in)}]{MU,  }\item[{double precision, intent(in)}]{GC,  }\item[{double precision, dimension(\+:,\+:), intent(in)}]{G\+A\+M\+MA,  }\item[{double complex, dimension(\+:,\+:,\+:), intent(out)}]{E\+M\+B\+S\+L\+FL,  }\item[{double complex, dimension(\+:,\+:,\+:), intent(out)}]{E\+M\+B\+S\+L\+FG }\end{DoxyParamCaption})}

\begin{DoxyParagraph}{Description}
\begin{DoxyVerb}    Computes the LESSER and GREATER components of the embedding 
    self-energies. It assumes the lead is at equilibrium and its
    state is describe by a Gibbs state with
    a given inverse temperature BETA and chemical potential MU\end{DoxyVerb}
 
\end{DoxyParagraph}

\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em D\+T\+I\+ME} & \begin{DoxyVerb}    DOUBLE PRECISION
    The time step\end{DoxyVerb}
 \\
\hline
\mbox{\texttt{ in}}  & {\em N\+T\+I\+ME} & \begin{DoxyVerb}    INTEGER
    Number of time steps\end{DoxyVerb}
 \\
\hline
\mbox{\texttt{ in}}  & {\em NS} & \begin{DoxyVerb}    INTEGER
    Size of the spatial/momentum/spin configuration space
    of the system\end{DoxyVerb}
 \\
\hline
\mbox{\texttt{ in}}  & {\em B\+E\+TA} & \begin{DoxyVerb}    DOUBLE PRECISION
    Inverse temperature of the lead \end{DoxyVerb}
 \\
\hline
\mbox{\texttt{ in}}  & {\em MU} & \begin{DoxyVerb}    DOUBLE PRECISION
    Chemical potential of the lead\end{DoxyVerb}
 \\
\hline
\mbox{\texttt{ in}}  & {\em GC} & \begin{DoxyVerb}    DOUBLE PRECISION
    System-lead coupling strenght 
    it is the entry of the coupling Hamiltonian\end{DoxyVerb}
 \\
\hline
\mbox{\texttt{ in}}  & {\em G\+A\+M\+MA} & \begin{DoxyVerb}    DOUBLE PRECISION, rank-2 array
    The adjaciency matrix of the system-lead coupling\end{DoxyVerb}
 \\
\hline
\mbox{\texttt{ out}}  & {\em E\+M\+B\+S\+L\+FL} & \begin{DoxyVerb}    DOUBLE COMPLEX, rank-3 array
    The first index if the time one
    The second and thid index coincide with those of GAMMA
    On exit the LESSER component of the embedding self-energy\end{DoxyVerb}
 \\
\hline
\mbox{\texttt{ out}}  & {\em E\+M\+B\+S\+L\+FL} & \begin{DoxyVerb}    DOUBLE COMPLEX, rank-3 array
    The first index if the time one
    The second and thid index coincide with those of GAMMA
    On exit the GREATER component of the embedding self-energy\end{DoxyVerb}
\\
\hline
\end{DoxyParams}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyAuthor}{Authors}
Cosco F., Lo Gullo N., Talarico W. 
\end{DoxyAuthor}


Definition at line 68 of file emb\+G\+K\+B\+A.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{68     }
\DoxyCodeLine{69     \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{70 \textcolor{comment}{!Useful numerical parameters}}
\DoxyCodeLine{71     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{parameter} :: zero = (0.0d0,0.0d0)   \textcolor{comment}{! Complex zero}}
\DoxyCodeLine{72     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{parameter} :: ci = (0.0d0,1.0d0)     \textcolor{comment}{! Complex unity}}
\DoxyCodeLine{73     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{parameter} :: pi = acos(-\/1.d0)     }
\DoxyCodeLine{74     }
\DoxyCodeLine{75 \textcolor{comment}{!Input variables}}
\DoxyCodeLine{76     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: NTIME}
\DoxyCodeLine{77     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)} :: NS}
\DoxyCodeLine{78     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)} :: DTIME}
\DoxyCodeLine{79     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(in)} :: BETA,MU,GC}
\DoxyCodeLine{80     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{intent(in)} :: GAMMA}
\DoxyCodeLine{81     }
\DoxyCodeLine{82 \textcolor{comment}{!Output variables}}
\DoxyCodeLine{83     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{dimension(:,:,:)}, \textcolor{keywordtype}{intent(out)} :: EMBSLFL, EMBSLFG}
\DoxyCodeLine{84 \textcolor{comment}{!Dummy variables}}
\DoxyCodeLine{85     \textcolor{keywordtype}{integer} :: i,j,tt, npeps, ntt}
\DoxyCodeLine{86     \textcolor{keywordtype}{double precision} :: epsmin, epsmax, deps, eps, tau}
\DoxyCodeLine{87     \textcolor{keywordtype}{double complex} ::  tmp}
\DoxyCodeLine{88     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: vtmp1,vtmp2}
\DoxyCodeLine{89 }
\DoxyCodeLine{90 }
\DoxyCodeLine{91 \textcolor{keyword}{allocate}(vtmp1(ntime+1))}
\DoxyCodeLine{92 \textcolor{keyword}{allocate}(vtmp2(ntime+1))}
\DoxyCodeLine{93 }
\DoxyCodeLine{94 \textcolor{comment}{! ntt=2.0d0*(nt-\/1)*10}}
\DoxyCodeLine{95 \textcolor{comment}{! deps = 2*pi/(dt*(ntt))}}
\DoxyCodeLine{96 \textcolor{comment}{! epsmin = -\/0.5*deps*ntt}}
\DoxyCodeLine{97 \textcolor{comment}{! epsmax = 0.5*deps*ntt}}
\DoxyCodeLine{98 }
\DoxyCodeLine{99 ntt=2.0d0*(ntime-\/1)}
\DoxyCodeLine{100 deps = 2*pi/(dtime*(ntt)) }
\DoxyCodeLine{101 epsmin = -\/0.5*deps*ntt}
\DoxyCodeLine{102 epsmax = 0.5*deps*ntt}
\DoxyCodeLine{103 }
\DoxyCodeLine{104 }
\DoxyCodeLine{105 embslfl=zero}
\DoxyCodeLine{106 embslfg=zero}
\DoxyCodeLine{107 }
\DoxyCodeLine{108 vtmp1(:)=zero}
\DoxyCodeLine{109 vtmp2(:)=zero}
\DoxyCodeLine{110 \textcolor{comment}{! ! lesser}}
\DoxyCodeLine{111 \textcolor{keywordflow}{do} tt=1,ntime+1}
\DoxyCodeLine{112 }
\DoxyCodeLine{113     tau=dtime*(tt-\/1)}
\DoxyCodeLine{114     tmp=zero}
\DoxyCodeLine{115     eps=epsmin}
\DoxyCodeLine{116     \textcolor{keywordflow}{do} npeps=1, ntt+1}
\DoxyCodeLine{117         tmp=tmp+0.5d0*deps/pi*\mbox{\hyperlink{fermi_8f90_a5735b27ace8339bbd7293f003036db74}{fermi}}(beta*(eps-\/mu))*exp(-\/ci*(eps)*tau)}
\DoxyCodeLine{118         eps=eps+deps}
\DoxyCodeLine{119 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121     vtmp1(tt)=tmp}
\DoxyCodeLine{122 }
\DoxyCodeLine{123 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125 }
\DoxyCodeLine{126 }
\DoxyCodeLine{127 \textcolor{keywordflow}{do} tt=1,ntime+1}
\DoxyCodeLine{128     embslfl(tt,1:ns,1:ns)=gc*gc*ci*vtmp1(tt)*gamma(1:ns,1:ns)}
\DoxyCodeLine{129 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{130 }
\DoxyCodeLine{131 }
\DoxyCodeLine{132 \textcolor{comment}{! greater}}
\DoxyCodeLine{133 \textcolor{keywordflow}{do} tt=1,ntime+1}
\DoxyCodeLine{134 }
\DoxyCodeLine{135     tau=dtime*(tt-\/1)}
\DoxyCodeLine{136     tmp=zero}
\DoxyCodeLine{137     eps=epsmin}
\DoxyCodeLine{138     \textcolor{keywordflow}{do} npeps=1, ntt+1}
\DoxyCodeLine{139         tmp=tmp+0.5d0*deps/pi*(1.0d0-\/\mbox{\hyperlink{fermi_8f90_a5735b27ace8339bbd7293f003036db74}{fermi}}(beta*(eps-\/mu)))*exp(-\/ci*(eps)*tau)}
\DoxyCodeLine{140         eps=eps+deps}
\DoxyCodeLine{141 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{142 }
\DoxyCodeLine{143     vtmp2(tt)=tmp}
\DoxyCodeLine{144 }
\DoxyCodeLine{145 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{146 }
\DoxyCodeLine{147 }
\DoxyCodeLine{148 \textcolor{keywordflow}{do} tt=1,ntime+1}
\DoxyCodeLine{149     embslfg(tt,1:ns,1:ns)=-\/gc*gc*ci*vtmp2(tt)*gamma(1:ns,1:ns)}
\DoxyCodeLine{150 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{151 }
\DoxyCodeLine{152  \textcolor{keyword}{deallocate}(vtmp1,vtmp2)}
\DoxyCodeLine{153 }
\DoxyCodeLine{154 }

\end{DoxyCode}
