\hypertarget{specfun_8f90}{}\doxysection{/home/nlgnico@ad.\+vtt.\+fi/\+Documents/\+N\+E\+G\+Fs/dyson-\/2t/src/specfun.f90 File Reference}
\label{specfun_8f90}\index{/home/nlgnico"@ad.vtt.fi/Documents/NEGFs/dyson-\/2t/src/specfun.f90@{/home/nlgnico"@ad.vtt.fi/Documents/NEGFs/dyson-\/2t/src/specfun.f90}}
\doxysubsection*{Functions/\+Subroutines}
\begin{Indent}\textbf{ S\+P\+E\+C\+F\+UN}\par
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{specfun_8f90_a692112b73c36d8781018aea60a9fc5ff}{specfun}} (scm, nps, npx, npt, tf, ttime, lg, descg, ll, descl, filenameout)
\end{DoxyCompactItemize}
\end{Indent}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{specfun_8f90_a692112b73c36d8781018aea60a9fc5ff}\label{specfun_8f90_a692112b73c36d8781018aea60a9fc5ff}} 
\index{specfun.f90@{specfun.f90}!specfun@{specfun}}
\index{specfun@{specfun}!specfun.f90@{specfun.f90}}
\doxysubsubsection{\texorpdfstring{specfun()}{specfun()}}
{\footnotesize\ttfamily subroutine specfun (\begin{DoxyParamCaption}\item[{character($\ast$)}]{scm,  }\item[{integer}]{nps,  }\item[{integer}]{npx,  }\item[{integer}]{npt,  }\item[{double precision}]{tf,  }\item[{integer}]{ttime,  }\item[{double complex, dimension(\+:,\+:)}]{lg,  }\item[{integer, dimension (\+:)}]{descg,  }\item[{double complex, dimension(\+:,\+:)}]{ll,  }\item[{integer, dimension (\+:)}]{descl,  }\item[{character($\ast$)}]{filenameout }\end{DoxyParamCaption})}

\begin{DoxyParagraph}{Description}
\begin{DoxyVerb} \end{DoxyVerb}
 
\end{DoxyParagraph}

\begin{DoxyParams}{Parameters}
{\em \mbox{[}$\,$\mbox{]}} & S\+CM \begin{DoxyVerb} \end{DoxyVerb}
 \\
\hline
{\em \mbox{[}$\,$\mbox{]}} & N\+PS \begin{DoxyVerb} \end{DoxyVerb}
 \\
\hline
{\em \mbox{[}$\,$\mbox{]}} & N\+PX \begin{DoxyVerb} \end{DoxyVerb}
 \\
\hline
{\em \mbox{[}$\,$\mbox{]}} & N\+PT \begin{DoxyVerb} \end{DoxyVerb}
 \\
\hline
{\em \mbox{[}$\,$\mbox{]}} & TF \begin{DoxyVerb} \end{DoxyVerb}
 \\
\hline
{\em \mbox{[}$\,$\mbox{]}} & T\+T\+I\+ME \begin{DoxyVerb} \end{DoxyVerb}
 \\
\hline
{\em \mbox{[}$\,$\mbox{]}} & LG \begin{DoxyVerb} \end{DoxyVerb}
 \\
\hline
{\em \mbox{[}$\,$\mbox{]}} & D\+E\+S\+CG \begin{DoxyVerb} \end{DoxyVerb}
 \\
\hline
{\em \mbox{[}$\,$\mbox{]}} & LL \begin{DoxyVerb} \end{DoxyVerb}
 \\
\hline
{\em \mbox{[}$\,$\mbox{]}} & D\+E\+S\+CL \begin{DoxyVerb} \end{DoxyVerb}
 \\
\hline
{\em \mbox{[}$\,$\mbox{]}} & F\+I\+L\+E\+N\+A\+M\+E\+O\+UT \begin{DoxyVerb} \end{DoxyVerb}
\\
\hline
\end{DoxyParams}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyAuthor}{Authors}
Cosco F., Lo Gullo N., Talarico W. 
\end{DoxyAuthor}


Definition at line 59 of file specfun.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{59     \textcolor{keywordtype}{use }mpi}
\DoxyCodeLine{60     \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{61 \textcolor{comment}{!Useful numerical parameters}}
\DoxyCodeLine{62     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{parameter} :: pi = dacos(-\/1.0d0)       \textcolor{comment}{! Pi greco}}
\DoxyCodeLine{63     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{parameter} :: ci = (0.0d0,1.0d0)         \textcolor{comment}{! Imaginary unit}}
\DoxyCodeLine{64     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{parameter} :: uno = (1.0d0,0.0d0)        \textcolor{comment}{! Complex one}}
\DoxyCodeLine{65     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{parameter} :: zero = (0.0d0,0.0d0)       \textcolor{comment}{! Complex zero}}
\DoxyCodeLine{66 \textcolor{comment}{!Input variables}}
\DoxyCodeLine{67     \textcolor{keywordtype}{character(*)} :: scm,filenameout}
\DoxyCodeLine{68     \textcolor{keywordtype}{integer} :: nps,npx,npt,ttime}
\DoxyCodeLine{69     \textcolor{keywordtype}{double precision} :: tf}
\DoxyCodeLine{70     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension (:)} :: descg}
\DoxyCodeLine{71     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{dimension(:,:)} :: lg}
\DoxyCodeLine{72     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension (:)} :: descl}
\DoxyCodeLine{73     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{dimension(:,:)} :: ll}
\DoxyCodeLine{74 \textcolor{comment}{!Varibles for grid query}}
\DoxyCodeLine{75     \textcolor{keywordtype}{integer} :: context,info,nprow,npcol,nprocs,myrow,mycol}
\DoxyCodeLine{76 \textcolor{comment}{!Dummy variables}}
\DoxyCodeLine{77     \textcolor{keywordtype}{integer} :: n,nnpt,npw,i,ip,tt,ttp,ltt,lttp,lits,litps,lit,litp}
\DoxyCodeLine{78     \textcolor{keywordtype}{integer} :: mb,nb,pr,pc,lldr,lldc,lldtr,lldtc,llditr,llditc,rsrc,csrc}
\DoxyCodeLine{79     \textcolor{keywordtype}{integer} :: numroc}
\DoxyCodeLine{80     \textcolor{keywordtype}{double precision} :: pzlange}
\DoxyCodeLine{81     \textcolor{keywordtype}{double precision} :: dt,dtau,k,eps,deps,epsmin,epsmax}
\DoxyCodeLine{82     \textcolor{keywordtype}{double precision} :: dalpha}
\DoxyCodeLine{83     \textcolor{keywordtype}{double complex} :: zalpha}
\DoxyCodeLine{84     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{allocatable} :: lakt, ltemp}
\DoxyCodeLine{85     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension (1:9)} :: descatau}
\DoxyCodeLine{86     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{allocatable} :: latau}
\DoxyCodeLine{87     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension (1:9)} :: descspec}
\DoxyCodeLine{88     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{allocatable} :: lspec}
\DoxyCodeLine{89     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension (1:9)} :: descexp}
\DoxyCodeLine{90     \textcolor{keywordtype}{double complex}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{allocatable} :: lexp }
\DoxyCodeLine{91     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{allocatable} :: vtt, vttp}
\DoxyCodeLine{92 }
\DoxyCodeLine{93 context = descl(2)}
\DoxyCodeLine{94 }
\DoxyCodeLine{95 \textcolor{keyword}{call }blacs\_gridinfo(context,nprow,npcol,myrow,mycol)}
\DoxyCodeLine{96 }
\DoxyCodeLine{97 \textcolor{keywordflow}{if} (ttime.le.npt) \textcolor{keywordflow}{then}}
\DoxyCodeLine{98     npw=ttime+1}
\DoxyCodeLine{99 \textcolor{keywordflow}{else}}
\DoxyCodeLine{100     npw=2*npt-\/ttime+1}
\DoxyCodeLine{101 \textcolor{keywordflow}{end if}}
\DoxyCodeLine{102 }
\DoxyCodeLine{103 lldtr=numroc(npw,1,myrow,0,nprow)}
\DoxyCodeLine{104 lldtc=numroc(npw,1,mycol,0,npcol)}
\DoxyCodeLine{105 }
\DoxyCodeLine{106 n=npx*npt}
\DoxyCodeLine{107 }
\DoxyCodeLine{108 llditr=numroc(n,npx,myrow,0,nprow)}
\DoxyCodeLine{109 llditc=numroc(n,npx,mycol,0,npcol)}
\DoxyCodeLine{110 }
\DoxyCodeLine{111 \textcolor{keyword}{allocate}(lakt(llditr,llditc),ltemp(llditr,llditc))}
\DoxyCodeLine{112 }
\DoxyCodeLine{113 lakt=zero}
\DoxyCodeLine{114 ltemp=zero}
\DoxyCodeLine{115 dt=tf/(npt-\/1)}
\DoxyCodeLine{116 }
\DoxyCodeLine{117 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!Trace over spin degrees of freedom!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{118 \textcolor{keywordflow}{do} tt=1,  lldtr  }
\DoxyCodeLine{119 \textcolor{keywordflow}{do} ttp=1, lldtc}
\DoxyCodeLine{120 }
\DoxyCodeLine{121 lit =(tt-\/1)*npx+1}
\DoxyCodeLine{122 litp=(ttp-\/1)*npx+1}
\DoxyCodeLine{123 }
\DoxyCodeLine{124 lits =(tt-\/1)*nps+1}
\DoxyCodeLine{125 litps=(ttp-\/1)*nps+1}
\DoxyCodeLine{126 }
\DoxyCodeLine{127 \textcolor{keywordflow}{do} i=1, npx}
\DoxyCodeLine{128 \textcolor{keywordflow}{do} ip=1, npx}
\DoxyCodeLine{129       lakt(lit+i-\/1,litp+ip-\/1) = ci*(lg(lits+(2*i-\/1)-\/1,litps+(2*ip-\/1)-\/1)-\/ll(lits+(2*i-\/1)-\/1,litps+(2*ip-\/1)-\/1)\&}
\DoxyCodeLine{130     \&+lg(lits+2*i-\/1,litps+2*ip-\/1)-\/ll(lits+2*i-\/1,litps+2*ip-\/1))}
\DoxyCodeLine{131 \textcolor{comment}{!     lakt(li+i-\/1,lip+ip-\/1) = exp(ci*(-\/pi+2.0d0*pi*(15-\/1)/nx)*(i-\/ip))+0.5d0*exp(ci*(-\/pi+2.0d0*pi*(18-\/1)/nx)*(i-\/ip))}}
\DoxyCodeLine{132 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{133 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{134 }
\DoxyCodeLine{135 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{136 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{137 \textcolor{comment}{!!!!!!!!!!!!!!!!!!Trace over spin degrees of freedom!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{138 }
\DoxyCodeLine{139 }
\DoxyCodeLine{140 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Exponential in space!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{141 \textcolor{keyword}{allocate}(lexp(npx,npx))}
\DoxyCodeLine{142 }
\DoxyCodeLine{143 lexp=zero}
\DoxyCodeLine{144 }
\DoxyCodeLine{145 \textcolor{keywordflow}{do} i=1, npx}
\DoxyCodeLine{146 \textcolor{keywordflow}{do} ip=1, npx}
\DoxyCodeLine{147     k = -\/pi+2.0d0*pi*(ip-\/1)/npx}
\DoxyCodeLine{148     lexp(ip,i)=exp(-\/ci*k*i)/sqrt(1.0d0*npx)}
\DoxyCodeLine{149 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{150 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{151 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Exponential in space!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{152 }
\DoxyCodeLine{153 ltemp=lakt}
\DoxyCodeLine{154 }
\DoxyCodeLine{155 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!Fourier transform in k-\/space!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{156 \textcolor{keywordflow}{do} tt=1,  lldtr}
\DoxyCodeLine{157 \textcolor{keywordflow}{do} ttp=1, lldtc}
\DoxyCodeLine{158 }
\DoxyCodeLine{159 lit =(tt-\/1)*npx+1}
\DoxyCodeLine{160 litp=(ttp-\/1)*npx+1}
\DoxyCodeLine{161 }
\DoxyCodeLine{162       lakt(lit:lit+npx-\/1,litp:litp+npx-\/1) = matmul(lexp,matmul(ltemp(lit:lit+npx-\/1,litp:litp+npx-\/1),conjg(transpose(lexp))))}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{165 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{166 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!Fourier transform in k-\/space!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{167 }
\DoxyCodeLine{168 }
\DoxyCodeLine{169 }
\DoxyCodeLine{170 }
\DoxyCodeLine{171 }
\DoxyCodeLine{172 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!Fourier in time!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{173 \textcolor{keyword}{deallocate}(lexp)}
\DoxyCodeLine{174 }
\DoxyCodeLine{175 npw=nnpt}
\DoxyCodeLine{176 }
\DoxyCodeLine{177 lldtr=numroc(npw,1,myrow,0,nprow)}
\DoxyCodeLine{178 lldtc=numroc(npw,1,mycol,0,npcol)}
\DoxyCodeLine{179 }
\DoxyCodeLine{180 \textcolor{keyword}{allocate}(vtt(lldtr),vttp(lldtc))}
\DoxyCodeLine{181 \textcolor{keyword}{allocate}(latau(lldtr,1),lspec(lldtr,1))}
\DoxyCodeLine{182 \textcolor{keyword}{allocate}(lexp(lldtr,lldtc))}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 \textcolor{keyword}{call }descinit(descatau,npw,1,1,1,0,0,context,lldtr,info)}
\DoxyCodeLine{185 \textcolor{keyword}{call }descinit(descspec,npw,1,1,1,0,0,context,lldtr,info)}
\DoxyCodeLine{186 \textcolor{keyword}{call }descinit(descexp,npw,npw,1,1,0,0,context,lldtr,info)}
\DoxyCodeLine{187 }
\DoxyCodeLine{188 vtt=0}
\DoxyCodeLine{189 vttp=0}
\DoxyCodeLine{190 }
\DoxyCodeLine{191 i=0}
\DoxyCodeLine{192 \textcolor{keywordflow}{do} tt=1, npw}
\DoxyCodeLine{193 pr=mod(floor(real(tt-\/1)),nprow)}
\DoxyCodeLine{194 \textcolor{keywordflow}{if}(myrow==pr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{195 i=i+1}
\DoxyCodeLine{196 vtt(i)=tt}
\DoxyCodeLine{197 \textcolor{keywordflow}{end if}}
\DoxyCodeLine{198 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{199 }
\DoxyCodeLine{200 i=0}
\DoxyCodeLine{201 \textcolor{keywordflow}{do} tt=1, npw}
\DoxyCodeLine{202 pc=mod(floor(real(tt-\/1)),npcol)}
\DoxyCodeLine{203 \textcolor{keywordflow}{if}(mycol==pc) \textcolor{keywordflow}{then}}
\DoxyCodeLine{204 i=i+1}
\DoxyCodeLine{205 vttp(i)=tt}
\DoxyCodeLine{206 \textcolor{keywordflow}{end if}}
\DoxyCodeLine{207 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{208 }
\DoxyCodeLine{209 lexp=zero}
\DoxyCodeLine{210 }
\DoxyCodeLine{211 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!EXPONENT!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{212 }
\DoxyCodeLine{213 epsmin=-\/pi/(2.0d0*dt)}
\DoxyCodeLine{214 epsmax=pi/(2.d0*dt)}
\DoxyCodeLine{215 deps=(epsmax-\/epsmin)/npw}
\DoxyCodeLine{216 }
\DoxyCodeLine{217 }
\DoxyCodeLine{218 \textcolor{keywordflow}{do} tt=1, lldtr}
\DoxyCodeLine{219 \textcolor{keywordflow}{do} ttp=1, lldtc}
\DoxyCodeLine{220     eps = epsmin+(vttp(ttp)-\/1)*deps}
\DoxyCodeLine{221     dtau = (2*vtt(tt)-\/ttime)*dt}
\DoxyCodeLine{222     lexp(tt,ttp)=exp(ci*eps*dtau)}
\DoxyCodeLine{223 }
\DoxyCodeLine{224 \textcolor{keywordflow}{end do} }
\DoxyCodeLine{225 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{226 }
\DoxyCodeLine{227 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{228 }
\DoxyCodeLine{229 }
\DoxyCodeLine{230 \textcolor{keyword}{call }blacs\_barrier(context,\textcolor{stringliteral}{'A'})}
\DoxyCodeLine{231 }
\DoxyCodeLine{232 }
\DoxyCodeLine{233 \textcolor{keywordflow}{if} (myrow==0.and.mycol==0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{234 \textcolor{keyword}{open}(unit=21,file=filenameout//\textcolor{stringliteral}{'r.dat'},access = \textcolor{stringliteral}{'sequential'},status=\textcolor{stringliteral}{'unknown'})}
\DoxyCodeLine{235 \textcolor{keyword}{open}(unit=22,file=filenameout//\textcolor{stringliteral}{'i.dat'},access = \textcolor{stringliteral}{'sequential'},status=\textcolor{stringliteral}{'unknown'})}
\DoxyCodeLine{236 \textcolor{keywordflow}{end if}}
\DoxyCodeLine{237 }
\DoxyCodeLine{238 }
\DoxyCodeLine{239 \textcolor{keywordflow}{do} i=1, npx}
\DoxyCodeLine{240 }
\DoxyCodeLine{241 \textcolor{keywordflow}{if} (mycol==0.and.myrow==0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{242     ip = i}
\DoxyCodeLine{243     \textcolor{keyword}{call }igebs2d(context,\textcolor{stringliteral}{'A'},\textcolor{stringliteral}{'i-\/ring'},1, 1,ip,1)}
\DoxyCodeLine{244 \textcolor{keywordflow}{else}    }
\DoxyCodeLine{245     \textcolor{keyword}{call }igebr2d(context,\textcolor{stringliteral}{'A'},\textcolor{stringliteral}{'i-\/ring'},1, 1,ip,1,0,0)}
\DoxyCodeLine{246 \textcolor{keywordflow}{end if}}
\DoxyCodeLine{247 }
\DoxyCodeLine{248 }
\DoxyCodeLine{249 latau=zero}
\DoxyCodeLine{250 }
\DoxyCodeLine{251 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{252 \textcolor{keywordflow}{do} tt=1, lldtr}
\DoxyCodeLine{253 zalpha = zero}
\DoxyCodeLine{254 \textcolor{keywordflow}{if}((ttime.le.npt.and.vtt(tt).le.ttime-\/1).or.(ttime>npt.and.vtt(tt).ge.ttime-\/npt)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{255     \textcolor{keywordflow}{if} (myrow==rsrc.and.mycol==csrc) \textcolor{keywordflow}{then}}
\DoxyCodeLine{256         lit =(ltt-\/1)*npx+1}
\DoxyCodeLine{257         litp=(lttp-\/1)*npx+1}
\DoxyCodeLine{258         }
\DoxyCodeLine{259         zalpha = zalpha + lakt(lit+ip-\/1,litp+ip-\/1)}
\DoxyCodeLine{260 }
\DoxyCodeLine{261         \textcolor{keywordflow}{if} (mycol==0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{262             latau(ltt,1) = zalpha}
\DoxyCodeLine{263         \textcolor{keywordflow}{else}    }
\DoxyCodeLine{264             \textcolor{keyword}{call }igebs2d(context,\textcolor{stringliteral}{'R'},\textcolor{stringliteral}{'i-\/ring'},1, 1,ltt,1)}
\DoxyCodeLine{265             \textcolor{keyword}{call }zgebs2d(context,\textcolor{stringliteral}{'R'},\textcolor{stringliteral}{'i-\/ring'},1, 1,zalpha,1)}
\DoxyCodeLine{266 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{267         }
\DoxyCodeLine{268     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (csrc/=0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{269         \textcolor{keyword}{call }igebr2d(context,\textcolor{stringliteral}{'R'},\textcolor{stringliteral}{'i-\/ring'},1, 1,ltt,1,rsrc,csrc)}
\DoxyCodeLine{270         \textcolor{keyword}{call }zgebr2d(context,\textcolor{stringliteral}{'R'},\textcolor{stringliteral}{'i-\/ring'},1, 1,zalpha,1,rsrc,csrc)}
\DoxyCodeLine{271         latau(ltt,1)=zalpha}
\DoxyCodeLine{272 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{273 }
\DoxyCodeLine{274 \textcolor{keywordflow}{end if}}
\DoxyCodeLine{275 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{276 }
\DoxyCodeLine{277 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{278 }
\DoxyCodeLine{279 \textcolor{keyword}{call }blacs\_barrier(context,\textcolor{stringliteral}{'A'})}
\DoxyCodeLine{280 }
\DoxyCodeLine{281 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{282 }
\DoxyCodeLine{283 lspec=zero}
\DoxyCodeLine{284 }
\DoxyCodeLine{285 \textcolor{comment}{!call pzgemv('T',nnpt,nnpt,uno*dt,lexp,1,1,descexp,latau,1,1,descatau,1,zero,lspec,1,1,descspec,1)}}
\DoxyCodeLine{286 \textcolor{keyword}{call }\mbox{\hyperlink{intgrtn_8f90_ae61e4c40452bc8008e91d73f0ea4c960}{intgrtn}} (scm,\textcolor{stringliteral}{'v'},npw,\textcolor{stringliteral}{'T'},\textcolor{stringliteral}{''},npw,npw,npw,2.d0*uno*dt,1.d0,0,lexp,1,1,descexp,latau,1,1,descatau,zero,lspec,1,1,descspec)}
\DoxyCodeLine{287 }
\DoxyCodeLine{288 \textcolor{keyword}{call }blacs\_barrier(context,\textcolor{stringliteral}{'A'})}
\DoxyCodeLine{289 }
\DoxyCodeLine{290 }
\DoxyCodeLine{291 \textcolor{keywordflow}{do} tt=1, npw}
\DoxyCodeLine{292     \textcolor{keyword}{call }infog2l(tt,1,descspec,nprow,npcol,myrow,mycol,ltt,lttp,rsrc,csrc)}
\DoxyCodeLine{293 }
\DoxyCodeLine{294     \textcolor{keywordflow}{if} (myrow==rsrc.and.mycol==csrc) \textcolor{keywordflow}{then}}
\DoxyCodeLine{295         zalpha = lspec(ltt,1)}
\DoxyCodeLine{296         \textcolor{keyword}{call }zgebs2d(context,\textcolor{stringliteral}{'A'},\textcolor{stringliteral}{'i-\/ring'},1, 1,zalpha,1)}
\DoxyCodeLine{297     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (myrow/=rsrc.or.mycol/=csrc) \textcolor{keywordflow}{then}}
\DoxyCodeLine{298         \textcolor{keyword}{call }zgebr2d(context,\textcolor{stringliteral}{'A'},\textcolor{stringliteral}{'i-\/ring'},1, 1,zalpha,1,rsrc,csrc)}
\DoxyCodeLine{299 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{300 }
\DoxyCodeLine{301     \textcolor{keywordflow}{if} (myrow==0.and.mycol==0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{302         \textcolor{keyword}{write}(21,*) real(zalpha)}
\DoxyCodeLine{303         \textcolor{keyword}{write}(22,*) aimag(zalpha)}
\DoxyCodeLine{304 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{305 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{306 }
\DoxyCodeLine{307 \textcolor{keyword}{call }blacs\_barrier(context,\textcolor{stringliteral}{'A'})}
\DoxyCodeLine{308 \textcolor{comment}{!Do sui k}}
\DoxyCodeLine{309 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{310 }
\DoxyCodeLine{311 }
\DoxyCodeLine{312 \textcolor{keywordflow}{if} (myrow==0.and.mycol==0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{313 \textcolor{keyword}{close}(21)}
\DoxyCodeLine{314 \textcolor{keyword}{close}(22)}
\DoxyCodeLine{315 \textcolor{keywordflow}{end if}}
\DoxyCodeLine{316 }

\end{DoxyCode}
