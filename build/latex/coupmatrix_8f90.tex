\hypertarget{coupmatrix_8f90}{}\doxysection{/home/nlgnico@ad.\+vtt.\+fi/\+Documents/\+N\+E\+G\+Fs/gkba/src/coupmatrix.f90 File Reference}
\label{coupmatrix_8f90}\index{/home/nlgnico"@ad.vtt.fi/Documents/NEGFs/gkba/src/coupmatrix.f90@{/home/nlgnico"@ad.vtt.fi/Documents/NEGFs/gkba/src/coupmatrix.f90}}
\doxysubsection*{Functions/\+Subroutines}
\begin{Indent}\textbf{ C\+O\+U\+P\+M\+A\+T\+R\+IX}\par
\begin{DoxyCompactItemize}
\item 
subroutine \mbox{\hyperlink{coupmatrix_8f90_a6fcdf586d4d22fefa489fcf82e1c3d4f}{coupmatrix}} (N\+PX, L\+DS, G\+A\+M\+MA)
\end{DoxyCompactItemize}
\end{Indent}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{coupmatrix_8f90_a6fcdf586d4d22fefa489fcf82e1c3d4f}\label{coupmatrix_8f90_a6fcdf586d4d22fefa489fcf82e1c3d4f}} 
\index{coupmatrix.f90@{coupmatrix.f90}!coupmatrix@{coupmatrix}}
\index{coupmatrix@{coupmatrix}!coupmatrix.f90@{coupmatrix.f90}}
\doxysubsubsection{\texorpdfstring{coupmatrix()}{coupmatrix()}}
{\footnotesize\ttfamily subroutine coupmatrix (\begin{DoxyParamCaption}\item[{integer, intent(in), optional}]{N\+PX,  }\item[{integer, dimension(\+:), intent(in)}]{L\+DS,  }\item[{double precision, dimension(\+:,\+:), intent(out)}]{G\+A\+M\+MA }\end{DoxyParamCaption})}

\begin{DoxyParagraph}{Description}
\begin{DoxyVerb}    Returns the coupling matrix to the lead\end{DoxyVerb}
 
\end{DoxyParagraph}

\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em N\+PX} & \begin{DoxyVerb}    INTEGER
    (OPTIONAL) the spatial/momentum dimension of the system
    to be used in case of spinned systems\end{DoxyVerb}
 \\
\hline
\mbox{\texttt{ in}}  & {\em L\+DS} & \begin{DoxyVerb}    INTEGER, rank-1 array
    Contains the sites/energy levels
    of the system to which the lead is coupled to\end{DoxyVerb}
 \\
\hline
\mbox{\texttt{ out}}  & {\em G\+A\+M\+MA} & \begin{DoxyVerb}    DOUBLE PRECISION, rank-2 array
    The adjacency matrix of the system-lead couplings\end{DoxyVerb}
 \\
\hline
\end{DoxyParams}
\begin{DoxyVersion}{Version}
0.\+1 
\end{DoxyVersion}
\begin{DoxyAuthor}{Authors}
Cosco F., Lo Gullo N., Talarico W. 
\end{DoxyAuthor}


Definition at line 30 of file coupmatrix.\+f90.


\begin{DoxyCode}{0}
\DoxyCodeLine{30     \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{31 \textcolor{comment}{!Input variables}}
\DoxyCodeLine{32     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: NPX}
\DoxyCodeLine{33     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{dimension(:)}, \textcolor{keywordtype}{intent(in)} :: LDS}
\DoxyCodeLine{34 \textcolor{comment}{!Output variables}}
\DoxyCodeLine{35     \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{intent(out)} :: GAMMA}
\DoxyCodeLine{36 \textcolor{comment}{!Dummy variables}}
\DoxyCodeLine{37     \textcolor{keywordtype}{integer} :: i,j}
\DoxyCodeLine{38 }
\DoxyCodeLine{39 gamma=0.0d0}
\DoxyCodeLine{40 }
\DoxyCodeLine{41 \textcolor{comment}{!do i=1, size(LDS)}}
\DoxyCodeLine{42 \textcolor{comment}{!!up}}
\DoxyCodeLine{43     \textcolor{comment}{!GAMMA(LDS(i),LDS(i)) = 1.0d0}}
\DoxyCodeLine{44 \textcolor{comment}{!end do}}
\DoxyCodeLine{45 }
\DoxyCodeLine{46 \textcolor{keywordflow}{do} i=1, \textcolor{keyword}{size}(lds)}
\DoxyCodeLine{47     \textcolor{keywordflow}{do} j=1, \textcolor{keyword}{size}(lds)}
\DoxyCodeLine{48         gamma(lds(i),lds(j)) = 1.0d0}
\DoxyCodeLine{49         gamma(lds(j),lds(i)) = 1.0d0}
\DoxyCodeLine{50 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{51 \textcolor{keywordflow}{end do}}
\DoxyCodeLine{52 }
\DoxyCodeLine{53 \textcolor{comment}{!!down      }}
\DoxyCodeLine{54 \textcolor{comment}{!   GAMMA(NPX+i,NPX+i) = 1.0d0}}
\DoxyCodeLine{55 }

\end{DoxyCode}
